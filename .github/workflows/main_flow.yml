name: main-flow
on:
  pull_request:
    branches:
      - main
jobs:
  clone-down:
    runs-on: ubuntu-latest
    steps:
      - name: clone-down
        uses: actions/checkout@v2
      - name: Upload Repo
        uses: actions/upload-artifact@v2
        with: 
          name: code
          path: .
  build:
    runs-on: ubuntu-latest
    # container: golang:latest # bla
    needs: [Clone-down]
    steps:
      - name: Download Repo
        uses: actions/download-artifact@v2
        with: 
          name: code
          path: .
      - name: build-frontend
        run: cd frontend && go build .    
      - name: build-backend
        run: cd backend &&  go mod download github.com/gomodule/redigo && go build . 
  test:
    runs-on: ubuntu-latest
    needs: [build]
    steps:
      - name: Download Repo
        uses: actions/download-artifact@v2
        with: 
          name: code
          path: .
      - name: test-front-end
        run: cd frontend && go test .  